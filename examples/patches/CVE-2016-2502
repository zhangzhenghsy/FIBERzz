diff --git a/drivers/usb/gadget/f_serial.c b/drivers/usb/gadget/f_serial.c
index 8d510e1..4e84de8 100644
--- a/drivers/usb/gadget/f_serial.c
+++ b/drivers/usb/gadget/f_serial.c
@@ -1361,6 +1361,13 @@ static long gser_ioctl(struct file *fp, unsigned cmd, unsigned long arg)
        smd_port_num =
            gserial_ports[gser->port_num].client_port_num;
 
+       if (smd_write_arg.size > GSERIAL_BUF_LEN) {
+           pr_err("%s: Invalid size:%u, max: %u", __func__,
+               smd_write_arg.size, GSERIAL_BUF_LEN);
+           ret = -EINVAL;
+           break;
+       }
+
        pr_debug("%s: Copying %d bytes from user buffer to local\n",
            __func__, smd_write_arg.size);
